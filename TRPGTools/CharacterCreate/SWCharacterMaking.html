<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>ソドワプロフィール作成</title>
</head>
<body>

    <p>ソード・ワールド2.5のランダムプロフィール作成ページです。</p>

    <div>
        <label>
            名前＆性別　
            <input type="button" value="7d6" id="nameDiceButton"><br />
            <textarea cols="60" rows="5" id="nameTextarea" placeholder="(例)&#13;SwordWorld2.5(7D6) ＞ 26[1,5,3,3,6,6,2] ＞ 26&#13;&#13;などのログ"></textarea>
            <br />
            経歴表　
            <input type="button" value="11d6" id="careerDiceButton"><br />
            <textarea cols="60" rows="5" id="CareerTextarea" placeholder="(例)&#13;SwordWorld2.5(11D6) ＞ 21[2,1,3,3,4,2,4,3,1,5,1] ＞ 21&#13;&#13;などのログ"></textarea>
        </label>
    </div>

    <div>
        <input type="button" value="Wロール" id="diceRollButton">
        <input type="button" value="作成" id="createButton">
        <input type="button" value="Wロール＆作成" id="rollAndCreateButton">
    </div>

    <p id="nameTxt"></p>

    <p id="careerTxt"></p>

    <script>
        // 解析ボタンクリック時のメイン処理
        function createProfile() {
            // 名前設定
            if (nameTextarea.value.length > 0) {
                var nameDices = splitByLine(nameTextarea.value);
                var name = createName(nameDices);
                nameTxt.innerText = name;
            }

            // 経歴設定
            if (CareerTextarea.value.length > 0) {
                var careerDices = splitByLine(CareerTextarea.value);
                var careerList = createCareer(careerDices);

                var career = '経歴表:\n' + careerList[0] + '\n' + careerList[1] + '\n' + careerList[2] + '\n\n冒険に出た理由表:\n' + careerList[3];
                careerTxt.innerText = career;
            }
        }

        // d6のログのみ抽出
        function splitByLine(msg) {
            var text = msg.replace(/\r\n|\r/g, "\n");
            var lines = text.split('\n');

            for (var i = 0; i < lines.length; i++) {
                // 空行は無視する
                if (lines[i] == '') {
                    continue;
                }
                // ダイスロールをしていない行は無視する
                if (lines[i].indexOf('[') < 0 || lines[i].indexOf(']') < 0) {
                    continue;
                }

                var rolls = lines[i].substring(lines[i].indexOf('[') + 1, lines[i].indexOf(']'));
                var outArray = rolls.split(',');
                var dices = new Array();

                for (var j = 0; j < outArray.length; j++) {
                    dices.push(parseInt(outArray[j]) - 1);
                }

                return dices;
            }

            return [0, 0, 0, 0, 0, 0, 0, 0];
        }

        // 名前設定
        function createName(dices) {
            // ランダム命名表
            let firstNameList = [
                [
                    ['アルフレッド', 'イリアス', 'ウォーレン', 'エリオット', 'オーウェン', 'カール'],
                    ['キース', 'クライド', 'ケネス', 'コーディ', 'サイラス', 'ショーン'],
                    ['スタンリー', 'セバスティアン', 'ソーン', 'ダリル', 'チェスター', 'テレンス'],
                    ['トニー', 'ナイジェル', 'ニール', 'ネイサン', 'ノア', 'バーニー'],
                    ['ヒューゴー', 'フェリックス', 'ヘイデン', 'マーティン', 'ミック', 'メルヴィン'],
                    ['モーガン', 'ユリシーズ', 'ランドルフ', 'リック', 'レックス', 'ロナルド']
                ], [
                    ['アリシア', 'イザベラ', 'ヴァネッサ', 'エイミー', 'オリヴィア', 'カレン'],
                    ['キャサリン', 'クリスティン', 'ケイティ', 'サンドラ', 'シーラ', 'ステイシー'],
                    ['セリーナ', 'ソニア', 'ターラ', 'チェルシー', 'ティナ', 'トレイシー'],
                    ['ナディーン', 'ニコル', 'ネリー', 'ノーラ', 'ハナ', 'ヒルダ'],
                    ['フェリシア', 'ヘレナ', 'ホリー', 'マリオン', 'ミラベル', 'メリッサ'],
                    ['モニカ', 'ラナ', 'リタ', 'ルイザ', 'レベッカ', 'ローザ']
                ], [
                    ['アリスティード', 'アルベール', 'イレネー', 'ヴァレリオ', 'エクトル', 'オディロン'],
                    ['カシミール', 'グウェナエル', 'クレール', 'ケヴィン', 'コースティアン', 'サシャ'],
                    ['ジェラール', 'シャール', 'ステファーヌ', 'セザール', 'ダヴィード', 'テオフィル'],
                    ['トリスティア', 'ナタナエル', 'ニルヴェール', 'ノエリア', 'ハトロクス', 'ヒエリーク'],
                    ['フィリスウェール', 'ヘランシェ', 'マスティア', 'ミシエール', 'モルガン', 'ヤニーク'],
                    ['ユーリッシュ', 'ラーフィエル', 'リーシェイル', 'ルノ', 'レイモン', 'ロラン']
                ], [
                    ['アルシェーヌ', 'イルセリエ', 'エルサリア', 'オルスティア', 'カルミール', 'クロティルト'],
                    ['ケイア', 'コレスティーヌ', 'サラセルス', 'シェス', 'スルセルサ', 'セレスティア'],
                    ['ソランシェル', 'タラサ', 'テシェレ', 'テュホーン', 'トーランサラーサ', 'ナティーシュ'],
                    ['ニナ', 'ヌエラ', 'ネサレット', 'ノミエール', 'ハルシネー', 'ファヴィエラ'],
                    ['フェリシア', 'ヘロイース', 'ポーラ', 'マルエリート', 'ミレーヌ', 'メリサンド'],
                    ['モニーク', 'ラシェル', 'リュクレース', 'ルイソン', 'レーヌ', 'ローラナ']
                ], [
                    ['アンスガル', 'イェスタフ', 'ヴィゴ', 'ヴィルゼル', 'エヴァルド', 'オスガル'],
                    ['ガルドホル', 'ギステルド', 'グンナル', 'ケルザー', 'ゴットフリュッド', 'サムセル'],
                    ['シグヴァルド', 'スヴァンテ', 'セルブレア', 'ゾル', 'ダルガッツ', 'ツヴァンテ'],
                    ['テオドル', 'トルヴィエン', 'ナータン', 'ニスモ', 'ネヴェアス', 'ハズガン'],
                    ['フレスト', 'ベルオフ', 'ポルトザール', 'マグヌス', 'ミケル', 'ムルガント'],
                    ['メイトリウス', 'モッス', 'ヤヴォ', 'ヨーンオロフ', 'ルバルト', 'レヴォン']
                ], [
                    ['アルヴァ', 'イェルダ', 'ヴォルキア', 'ウルスラ', 'エディト', 'オルガ'],
                    ['カイサ', 'キャロリナ', 'クリスタ', 'ケイト', 'コアナ', 'サンドラ'],
                    ['シェスティナ', 'スヴェア', 'セルマ', 'ソルヴェイ', 'ダニエラ', 'ティルダ'],
                    ['トーラ', 'パウラ', 'ピア', 'ブリット', 'ペトロネラ', 'ボエル'],
                    ['マルティナ', 'ミリヤム', 'ムーナ', 'メティア', 'モルティア', 'ユーリア'],
                    ['ヨセフィン', 'ラウラ', 'リアーネ', 'ルイス', 'レーナ', 'ロリ']
                ]];
            let familyNameList = [
                [
                    ['アスター', 'イーストン', 'ヴィンセント', 'エアハート', 'オーズリー', 'カークランド'],
                    ['キンケイド', 'クロフォード', 'ケアリー', 'コーネル', 'サックウェル', 'シアーズ'],
                    ['スウィフト', 'セルウェイ', 'ソーウェル', 'タナー', 'チェンバーズ', 'テイラー'],
                    ['トムソン', 'ナイセル', 'ニューマン', 'ネヴィル', 'ノートン', 'ハンフリー'],
                    ['ヒューズ', 'ファレル', 'ヘイデン', 'マクレーン', 'ミーガン', 'ムーア'],
                    ['メイトランド', 'ラザフォード', 'リドリー', 'ルーク', 'レストン', 'ロドニー']
                ], [
                    ['アシャール', 'イウェルフ', 'ウルシェ', 'エモニア', 'オリオレール', 'カランファリア'],
                    ['キーフィリス', 'ククルアレ', 'ケルスイール', 'コデルリエ', 'サラスリエン', 'シャサシェール'],
                    ['スラシャフィ', 'セヴァノン', 'ソロン', 'ターラシオン', 'ツラッセス', 'テアドラール'],
                    ['トーラス', 'ナヴァール', 'ニスウェヌス', 'ヌヴ', 'ネルファヴル', 'ノティエ'],
                    ['ハルファルフィエ', 'ヒルヴレシュ', 'フルセルシア', 'ヘクティス', 'マロール', 'ミスケス'],
                    ['ムルマワール', 'メレスケレス', 'モートルケーラ', 'ヤルシェラス', 'リスナール', 'ローロシェーナス']
                ], [
                    ['アベニウス', 'イェネストレーム', 'エルヴェスト', 'オルスティット', 'カーシェイン', 'クロンヘイム'],
                    ['コルゲンバリ', 'サリアン', 'シルヴマルク', 'スドヴァネル', 'セーデルフェルト', 'ダリアン'],
                    ['ディクスゴード', 'ナヴァレ', 'ニカルド', 'ヌルマン', 'ネレム', 'ノシュテット'],
                    ['バルテルス', 'ビルクンド', 'ブリムダール', 'ベンディクス', 'ボレリウス', 'マルムグレーン'],
                    ['ミュルダール', 'ムバリ', 'メランデル', 'モルゲン', 'ヤーデルード', 'ユルトルム'],
                    ['ヨラン', 'ラーシャルード', 'リルクヴィスト', 'ルルヴィエ', 'レイナルト', 'ロセアン']
                ]];
            let sexList = ['男', '女', 'その他', 'なし', '不明', '不詳'];

            // 名前設定
            var firstName = firstNameList[dices[0]][dices[1]][dices[2]];
            var familyName = familyNameList[dices[3] / 2 | 0][dices[4]][dices[5]];
            var name = firstName + '・' + familyName + ' 性別：' + sexList[dices[6]];

            return name;
        }

        // 経歴設定
        function createCareer(dices) {
            // 経歴表
            let carrerListA =
                [
                    ['A-1-1 大恋愛したことがある', 'A-1-2 命を救われたことがある', 'A-1-3 子供のころに家出したことがある', 'A-1-4 破産したことがある', 'A-1-5 罪を犯したことがある', 'A-1-6 憧れる冒険者がいる'],
                    ['A-2-1 臨死体験したことがある', 'A-2-2 裕福な家に生まれた', 'A-2-3 育ての親に拾われた', 'A-2-4 家族に異種族がいる', 'A-2-5 かつては貴族だった', 'A-2-6 大失恋したことがある'],
                    ['A-3-1 大怪我をしたことがある', 'A-3-2 一定期間の記憶がない', 'A-3-3 奇妙な予言をされたことがある', 'A-3-4 本来とは異なる性別として育てられた', 'A-3-5 許婚がいる（いた）', 'A-3-6 大きな挫折をしたことがある'],
                    ['A-4-1 投獄されたことがある', 'A-4-2 裏切られたことがある', 'A-4-3 忘れられない恐怖を体験したことがある', 'A-4-4 両親に愛されて育った', 'A-4-5 誰かを救ったことがある', 'A-4-6 有名人の友達がいる（いた）'],
                    ['A-5-1 大きな遺跡を発見したことがある', 'A-5-2 まだ恋をしたことがない', 'A-5-3 故郷の場所を知らない', 'A-5-4 のめり込む趣味がある', 'A-5-5 才能を絶賛されたことがある', 'A-5-6 ガキ大将だった'],
                    ['A-6-1 神の声を聞いたことがある（と信じている）', 'A-6-2 溺れたことがある', 'A-6-3 予知夢を見たことがある', 'A-6-4 体のどこかに刺青がある', 'A-6-5 血縁者と死別したことがある', 'A-6-6 役に立たない知識を持っている']
                ];
            let carrerListB =
                [
                    ['B-1-1 大きな失敗をしたことがある', 'B-1-2 師と呼べる人物がいる', 'B-1-3 異種族の友人がいる', 'B-1-4 大切な約束をしたことがある', 'B-1-5 大病を患ったことがある', 'B-1-6 かつて信頼できる友人がいた'],
                    ['B-2-1 異種族の街で育った', 'B-2-2 同じ夢を何度も見ている', 'B-2-3 田舎で育った', 'B-2-4 競い合う友人がいた', 'B-2-5 魔物に襲われたことがある', 'B-2-6 本から大きな影響を受けたことがある'],
                    ['B-3-1 告白されたことがある', 'B-3-2 何かの大会で優勝したことがある', 'B-3-3 近所では一番の物知りだった', 'B-3-4 忘れられないほど美味しいものを知っている', 'B-3-5 歳の離れた友人がいる（いた）', 'B-3-6 父親が旅に出ている（いた）'],
                    ['B-4-1 商売を手伝ったことがある', 'B-4-2 大ゲンカしたことがある', 'B-4-3 近所に芸術家が住んでいる（いた）', 'B-4-4 大切な約束をしている', 'B-4-5 毒を飲んだ（食べた）ことがある', 'B-4-6 知り合いに生き返った人がいる'],
                    ['B-5-1 異種族を怖がっている（いた）', 'B-5-2 魔物を倒したことがある', 'B-5-3 大切な人と生き別れている', 'B-5-4 役に立たない得意技がある', 'B-5-5 過去に仕えた主がいた', 'B-5-6 絶対に知られたくない秘密がある'],
                    ['B-6-1 恥ずかしい癖を持っている', 'B-6-2 自分にそっくりな人物を知っている', 'B-6-3 命を助けられたことがある', 'B-6-4 特定の異種族を好んでいる（いた）', 'B-6-5 引きこもっていたことがある', 'B-6-6 始まりの剣を求めている（いた）']
                ];
            let carrerListC =
                [
                    ['C-1-1 伴侶がいる（いた）', 'C-1-2 敵対する者がいる（いた）', 'C-1-3 目標としている人がいる（いた）', 'C-1-4 かつて従者がいた', 'C-1-5 未だ叶わない夢がある', 'C-1-6 純潔である'],
                    ['C-2-1 規律に厳しい環境で育った', 'C-2-2 家族から探されている', 'C-2-3 旅をしたことがない', 'C-2-4 身体に傷痕がある', 'C-2-5 卵を温めたことがある', 'C-2-6 歌を褒められたことがない'],
                    ['C-3-1 大きな嘘をついている（いた）', 'C-3-2 大好きな食べ物がある（あった）', 'C-3-3 苦手な動物がいる（いた）', 'C-3-4 恥ずかしいあだ名を持っている（いた）', 'C-3-5 決して手放せない小物がある', 'C-3-6 己に何らかの誓いを立てている（いた）'],
                    ['C-4-1 家族に魔法使いがいる（いた）', 'C-4-2 監禁されたことがある', 'C-4-3 「負けず嫌い」と評されたことがある', 'C-4-4 冒険に誘われたことがある', 'C-4-5 濡れ衣を着せられたことがある', 'C-4-6 高レベルの魔法をかけられたことがある'],
                    ['C-5-1 物心ついたときには独りだった', 'C-5-2 ５人以上の兄弟姉妹がいる（いた）', 'C-5-3 家族に冒険者がいる（いた）', 'C-5-4 魔剣の迷宮で迷子になったことがある', 'C-5-5 同性の家族がいない', 'C-5-6 異性の家族がいない'],
                    ['C-6-1 守りの剣を手に持ったことがある', 'C-6-2 一か所に５日以上滞在したことがない', 'C-6-3 国王に会ったことがある', 'C-6-4 空腹のあまりに失神したことがある', 'C-6-5 飛空船に乗ったことがある', 'C-6-6 自殺を試みたことがある']
                ];
            let carrerListD =
                [
                    ['1-1 蛮族を倒すため', '1-2 奈落を滅ぼすため', '1-3 一攫千金を狙って', '1-4 倒したい相手がいる', '1-5 破産した', '1-6 故郷にいられなくなって'],
                    ['2-1 探している人がいる', '2-2 探しているものがある', '2-3 目指すべき場所がある', '2-4 王になる', '2-5 失われた場所を取り戻す', '2-6 最強の存在になるため'],
                    ['3-1 見聞を広めるため', '3-2 身分を隠すため', '3-3 親に言われて', '3-4 親に反発して', '3-5 家族を養うため', '3-6 最高の冒険者になるため'],
                    ['4-1 恐怖に打ち勝つため', '4-2 神になる', '4-3 病の家族・恋人を救うため', '4-4 なりゆき', '4-5 友達に勧められて', '4-6 家族をすべて失ったので'],
                    ['5-1 故郷を滅ぼされたので', '5-2 家族・仲間の敵を討つため', '5-3 まだ見ぬ世界を見るため', '5-4 失われた家門を取り戻すため', '5-5 予言によって', '5-6 他に生き方がなくて'],
                    ['6-1 名声を得るために', '6-2 自由のために', '6-3 無理やり巻き込まれて', '6-4 人々を守るため', '6-5 失われた文明を取り戻すため', '6-6 平和を求めて']
                ];
            let carrerListABC = [carrerListA, carrerListB, carrerListC]

            // 名前設定
            var carrerA = carrerListABC[parseInt(dices[0] / 2)][dices[1]][dices[2]];
            var carrerB = carrerListABC[parseInt(dices[3] / 2)][dices[4]][dices[5]];
            var carrerC = carrerListABC[parseInt(dices[6] / 2)][dices[7]][dices[8]];
            var carrerD = carrerListD[dices[9]][dices[10]];
            var carrerList = [carrerA, carrerB, carrerC, carrerD];

            return carrerList;
        }

        // 名前＆性別ダイスロール
        function roll7d6() {
            var dices = new Array();
            var sum = 0;
            for (var i = 0; i < 7; i++) {
                dices.push(Math.floor(Math.random() * 6) + 1);
                sum += dices[i];
            }
            nameTextarea.value = '7d6 名前＆性別 (7D6) ＞ ' + sum + '[' + dices + '] ＞ ' + sum;
        }

        // 経歴表ダイスロール
        function roll11d6() {
            var dices = new Array();
            var sum = 0;
            for (var i = 0; i < 11; i++) {
                dices.push(Math.floor(Math.random() * 6) + 1);
                sum += dices[i];
            }
            CareerTextarea.value = '11d6 経歴表 (11D6) ＞ ' + sum + '[' + dices + '] ＞ ' + sum;
        }

        // Wダイスロール
        function doubleRoll() {
            roll7d6();
            roll11d6();
        }

        // Wダイスロール＆プロフィール作成
        function rollAndCreate() {
            doubleRoll();
            createProfile();
        }

        // 7d6ボタン
        let nameDiceButton = document.getElementById('nameDiceButton');
        nameDiceButton.addEventListener('click', roll7d6);

        // 11d6ボタン
        let careerDiceButton = document.getElementById('careerDiceButton');
        careerDiceButton.addEventListener('click', roll11d6);

        // Wロールボタン
        let diceRollButton = document.getElementById('diceRollButton');
        diceRollButton.addEventListener('click', doubleRoll);

        // 作成ボタン
        let createButton = document.getElementById('createButton');
        createButton.addEventListener('click', createProfile);

        // Wロール＆ボタン
        let rollAndCreateButton = document.getElementById('rollAndCreateButton');
        rollAndCreateButton.addEventListener('click', rollAndCreate);
    </script>

</body>
</html>